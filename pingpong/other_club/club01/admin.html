<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ“ ê´€ë¦¬ì ëª¨ë“œ</title>
<style>
:root{
  --ink:#0f172a; --muted:#64748b; --bg:#f5f7fb;
  --primary:#0d47a1; --accent:#2563eb; --danger:#ef4444; --ok:#16a34a;
}
body{margin:0;font-family:system-ui,"Noto Sans KR",sans-serif;background:var(--bg);color:var(--ink)}
.wrap{max-width:640px;margin:0 auto;padding:20px}
h1{text-align:center;color:var(--primary)}
.card{background:#fff;border-radius:12px;padding:16px;margin-top:12px;box-shadow:0 2px 10px rgba(0,0,0,.05)}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
input{padding:6px 8px;font-size:14px;border:1px solid #ccc;border-radius:6px}
.btn{border:1px solid #ccc;border-radius:6px;padding:6px 10px;font-size:14px;cursor:pointer}
.btn.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
.btn.warn{background:var(--danger);color:#fff;border-color:var(--danger)}
.btn.ok{background:var(--ok);color:#fff;border-color:var(--ok)}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #e5e7eb;padding:6px;text-align:center;font-size:14px}
thead{background:#f1f5f9}
.toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);
background:#111827;color:#fff;padding:8px 12px;border-radius:10px;opacity:0;transition:.25s}
.toast.show{opacity:1}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸ“ PingPong Club ê´€ë¦¬ì</h1>

  <!-- ì„ ìˆ˜ ë“±ë¡ -->
  <div class="card">
    <h3>ì„ ìˆ˜ ë“±ë¡</h3>
    <div class="row">
      <input id="name" type="text" placeholder="ì´ë¦„ ì…ë ¥ (ì˜ˆ: ê¹€ìŠ¹ì¼)" />
      <input id="level" type="number" placeholder="ë¶€ìˆ˜" style="width:80px" />
      <button id="add" class="btn primary">ë“±ë¡</button>
    </div>
    <small style="color:var(--muted)">ì…ë ¥ í›„ ë“±ë¡ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ Firebaseì— ë°”ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</small>

    <table>
      <thead><tr><th>ì´ë¦„</th><th>ë¶€ìˆ˜</th><th>ìƒíƒœ</th><th>ê´€ë¦¬</th></tr></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<div id="toast" class="toast">ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, push, set, remove, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

// âœ… Firebase ì—°ê²°
const firebaseConfig = {
  apiKey: "AIzaSyArRznuWhfuiOA1vFtwlArMCLsAdTz6XHo",
  authDomain: "pingpongclub-4a5fd.firebaseapp.com",
  databaseURL: "https://pingpongclub-4a5fd-default-rtdb.firebaseio.com",
  projectId: "pingpongclub-4a5fd",
  storageBucket: "pingpongclub-4a5fd.firebasestorage.app",
  messagingSenderId: "802826774007",
  appId: "1:802826774007:web:ca4d05be778eeaf1723af2"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const playerRef = ref(db, "players");

const $ = (s) => document.querySelector(s);
const toast = (msg="ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤")=>{
  const t=$("#toast");t.textContent=msg;t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),1500);
};

// âœ… ì‹¤ì‹œê°„ ì„ ìˆ˜ ëª©ë¡ í‘œì‹œ
onValue(playerRef, (snap)=>{
  const tbody=$("#tbody");
  tbody.innerHTML="";
  const data=snap.val()||{};
  Object.entries(data).forEach(([id,p])=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${p.name}</td>
      <td>${p.level}</td>
      <td>${p.hidden?"ìˆ¨ê¹€":"í™œì„±"}</td>
      <td>
        ${p.hidden
          ? `<button class="btn ok" onclick="unhide('${id}')">ë³µêµ¬</button>`
          : `<button class="btn warn" onclick="hide('${id}')">ìˆ¨ê¹€</button>`}
        <button class="btn warn" onclick="del('${id}')">ì‚­ì œ</button>
      </td>`;
    tbody.appendChild(tr);
  });
});

// âœ… ë“±ë¡ ë²„íŠ¼ í´ë¦­ â†’ Firebaseì— push
$("#add").onclick = async ()=>{
  const name=$("#name").value.trim();
  const level=parseInt($("#level").value)||0;
  if(!name){toast("ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”");return;}
  await push(playerRef,{name,level,hidden:false,joinedAt:Date.now()});
  $("#name").value="";$("#level").value="";
  toast("ì„ ìˆ˜ ë“±ë¡ ì™„ë£Œ");
};

// âœ… ìˆ¨ê¹€/ë³µêµ¬/ì‚­ì œ í•¨ìˆ˜
window.hide=async(id)=>{await set(ref(db,`players/${id}/hidden`),true);toast("ìˆ¨ê¹€ ì²˜ë¦¬ë¨");};
window.unhide=async(id)=>{await set(ref(db,`players/${id}/hidden`),false);toast("ë³µêµ¬ë¨");};
window.del=async(id)=>{
  if(!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))return;
  await remove(ref(db,`players/${id}`));toast("ì‚­ì œ ì™„ë£Œ");
};
</script>
</body>
</html>
