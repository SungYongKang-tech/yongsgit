<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Makeup Lesson Manager</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Pretendard",sans-serif;
  margin:0; background:#f5f5f7;
}

header{
  padding:16px; font-size:1.3rem; font-weight:700;
  background:#fff; border-bottom:1px solid #ddd;
}

/* 레슨 시간표 */
table{ width:100%; border-collapse:collapse; background:white; margin-top:10px;}
th,td{ border:1px solid #ccc; padding:10px; text-align:center; }
td.selectable{ cursor:pointer; }
td.selected{ background:#2563eb; color:white; }

/* 보강 대상자 */
.list{ padding:16px; }
.item{
  background:#fff; padding:14px; margin-bottom:10px;
  border-radius:10px; border-left:6px solid #2563eb;
}

/* 스케쥴 */
.slot{
  padding:12px; background:white; border:1px solid #ddd;
  border-radius:8px; margin-bottom:8px; cursor:pointer;
}
.slot.assigned{
  background:#2563eb; color:white; font-weight:700;
}

/* 보강 대상자 선택 */
.name-item{
  background:#fff; border:1px solid #ddd;
  padding:10px; border-radius:8px; cursor:pointer;
  margin-bottom:6px;
}
.name-item.active{
  background:#2563eb; color:white;
}
</style>
</head>
<body>

<header>레슨 시간표</header>

<div style="padding:12px;">
<table>
  <thead>
    <tr>
      <th>시간</th>
      <th>월</th>
      <th>화</th>
      <th>수</th>
      <th>목</th>
    </tr>
  </thead>
  <tbody id="lessonBody"></tbody>
</table>

<!-- 보강자 생성 버튼 -->
<button onclick="createMakeupTargets()"
  style="width:100%; padding:12px; margin-top:10px; border:none;
         background:#2563eb; color:white; font-size:1rem; border-radius:8px;">
  보강자 생성
</button>
</div>

<header>보강 대상자</header>
<div class="list" id="makeupList"></div>

<header>보강 스케쥴</header>
<div style="padding:16px;">
  <button onclick="generateSchedule()"
    style="width:100%; padding:12px; border:none;
           background:#16a34a; color:white; font-size:1rem; border-radius:8px;">
    보강 스케쥴 생성
  </button>

  <h3 style="margin-top:16px;">시간표</h3>
  <div id="scheduleBox"></div>

  <h3 style="margin-top:16px;">보강 대상자</h3>
  <div id="nameList"></div>
</div>

<script>
// --------------------------------------
// 1) 레슨 시간표 데이터
// --------------------------------------
const timetable = {
  "15:00": {mon:"정승목", tue:"이세란", wed:"정승목", thu:"이세란"},
  "15:30": {mon:"이상준", tue:"박나령", wed:"이상준", thu:"박나령"},
  "16:00": {mon:"이낭주", tue:"김승일", wed:"이낭주", thu:"김승일"},
  "16:30": {mon:"조보미", tue:"송은아", wed:"조보미", thu:"송은아"},
};

const dayKor = {mon:"월", tue:"화", wed:"수", thu:"목"};

let selectedCells = [];    // 시간표에서 선택된 칸
let makeupTargets = [];    // 보강 대상자 리스트
let assignedSchedule = {}; // 실제 보강 스케쥴
let selectedName = null;   // 보강 스케쥴 배정할 대상자

// --------------------------------------
// 2) 레슨 시간표 렌더
// --------------------------------------
function renderLessonTable(){
  const body = document.getElementById("lessonBody");
  body.innerHTML="";

  Object.keys(timetable).forEach(time=>{
    const tr = document.createElement("tr");
    tr.innerHTML += `<td>${time}</td>`;

    ["mon","tue","wed","thu"].forEach(day=>{
      const name = timetable[time][day];
      const td = document.createElement("td");
      td.className="selectable";
      td.innerText = name;
      td.onclick = ()=>toggleSelect(time,day,name,td);
      tr.appendChild(td);
    });

    body.appendChild(tr);
  });
}

function toggleSelect(time, day, name, td){
  const key = `${time}_${day}_${name}`;

  if(selectedCells.includes(key)){
    selectedCells = selectedCells.filter(x => x !== key);
    td.classList.remove("selected");
  }else{
    selectedCells.push(key);
    td.classList.add("selected");
  }
}

// --------------------------------------
// 3) 보강자 생성
// --------------------------------------
function createMakeupTargets(){
  selectedCells.forEach(key=>{
    const [time,day,name] = key.split("_");
    makeupTargets.push({name,day,time});
  });

  selectedCells = []; // 초기화
  renderMakeupTargets();
  renderLessonTable();
}

function renderMakeupTargets(){
  const box = document.getElementById("makeupList");
  box.innerHTML="";

  if(makeupTargets.length===0){
    box.innerHTML = `<div style="color:#666;">보강 대상자 없음</div>`;
    return;
  }

  makeupTargets.forEach(m=>{
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML = `
      <div class="name">${m.name}</div>
      <div class="sub">${dayKor[m.day]}요일 ${m.time}</div>
    `;
    box.appendChild(div);
  });

  renderNameList();
}

// --------------------------------------
// 4) 보강 스케쥴 생성
// --------------------------------------
function generateSchedule(){
  const box = document.getElementById("scheduleBox");
  box.innerHTML="";

  const slots = [];
  for(let h=14;h<18;h++){
    for(let m=0;m<60;m+=15){
      const hh = String(h).padStart(2,"0");
      const mm = String(m).padStart(2,"0");
      slots.push(`${hh}:${mm}`);
    }
  }

  slots.forEach(t=>{
    const div = document.createElement("div");
    div.className="slot";
    div.innerText = t;
    div.onclick = ()=>assignTime(t, div);
    box.appendChild(div);
  });
}

// --------------------------------------
// 5) 보강 대상자 이름 선택
// --------------------------------------
function renderNameList(){
  const box = document.getElementById("nameList");
  box.innerHTML="";

  makeupTargets.forEach((m,i)=>{
    const div = document.createElement("div");
    div.className="name-item";
    div.innerText = m.name;

    div.onclick = ()=>{
      selectedName = m.name;
      document.querySelectorAll(".name-item").forEach(n => n.classList.remove("active"));
      div.classList.add("active");
    };

    box.appendChild(div);
  });
}

// --------------------------------------
// 6) 시간 클릭 → 이름 이동
// --------------------------------------
function assignTime(time, slotDiv){
  if(!selectedName){
    alert("보강 대상자를 먼저 선택해주세요.");
    return;
  }

  // 시간표에 배정
  assignedSchedule[time] = selectedName;

  // 보강 대상자 리스트에서 제거
  makeupTargets = makeupTargets.filter(m => m.name !== selectedName);

  // UI 표시
  slotDiv.innerText = `${time}  ${selectedName}`;
  slotDiv.classList.add("assigned");

  // 업데이트
  selectedName = null;
  renderMakeupTargets();
}

renderLessonTable();
renderMakeupTargets();
</script>

</body>
</html>
