<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Makeup Lesson Manager</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Pretendard",sans-serif;
  margin:0; background:#f5f5f7;
}

/* 제목 */
header{
  padding:16px; background:#fff; 
  font-size:1.3rem; font-weight:700;
  border-bottom:1px solid #ddd;
}

/* 레슨 표 */
table{
  width:100%; border-collapse:collapse; background:white;
  margin-top:12px;
}
th, td{
  border:1px solid #ccc;
  padding:10px; text-align:center;
}
td.selectable{ cursor:pointer; }
td.selected{ background:#2563eb; color:white; }

/* 사이드 버튼 */
.right-btn{
  position:fixed; right:12px; top:12px;
  background:#2563eb; color:#fff;
  padding:10px 12px; border-radius:8px;
  font-weight:700;
}

/* 보강 대상 리스트 */
.list{
  padding:16px;
}
.item{
  background:#fff; padding:14px; border-radius:10px;
  margin-bottom:10px; border-left:5px solid #2563eb;
}

/* 보강 시간표 */
.schedule-box{
  padding:16px;
}
.slot{
  padding:12px; background:white; 
  margin-bottom:8px; border-radius:8px; 
  border:1px solid #ddd; cursor:pointer;
}
.slot.selected{
  background:#2563eb; color:white;
}
.name-item{
  padding:10px; background:#fff; 
  border:1px solid #ddd; border-radius:8px;
  cursor:pointer; margin-bottom:6px;
}
.name-item.active{
  background:#2563eb; color:white;
}

</style>
</head>
<body>

<header>레슨 시간표</header>

<!-- 보강 스케줄 생성 버튼 -->
<div class="right-btn" onclick="showMakeupSchedule()">보강 스케줄 생성</div>

<!-- 레슨 시간표 -->
<div style="padding:12px;">
<table id="lessonTable">
  <thead>
    <tr>
      <th>시간</th>
      <th>월</th>
      <th>화</th>
      <th>수</th>
      <th>목</th>
    </tr>
  </thead>
  <tbody id="lessonBody"></tbody>
</table>

<button onclick="createMakeupTargets()" style="margin-top:10px; padding:10px; width:100%; border:none; background:#2563eb; color:white; font-size:1rem; border-radius:8px;">
  보강 대상자 생성
</button>
</div>

<header>보강 대상자</header>
<div class="list" id="makeupList"></div>

<!-- 보강 스케줄 영역 -->
<header>보강 스케줄</header>
<div class="schedule-box">
  <h3>보강 대상자</h3>
  <div id="nameList"></div>

  <h3 style="margin-top:16px;">시간 선택</h3>
  <div id="timeSlots"></div>
</div>

<script>
// ------------------------------
// 1) 레슨 시간표 데이터
// ------------------------------
const timetable = {
  "15:00": {mon:"정승목", tue:"이세란", wed:"정승목", thu:"이세란"},
  "15:30": {mon:"이상준", tue:"박나령", wed:"이상준", thu:"박나령"},
  "16:00": {mon:"이낭주", tue:"김승일", wed:"이낭주", thu:"김승일"},
  "16:30": {mon:"조보미", tue:"송은아", wed:"조보미", thu:"송은아"}
};

// ------------------------------
// 2) 레슨 표 렌더링
// ------------------------------
let selectedCells = []; // 보강 생성 대상

function renderLessonTable(){
  const body = document.getElementById("lessonBody");
  body.innerHTML="";

  Object.keys(timetable).forEach(time=>{
    const row = document.createElement("tr");

    // 왼쪽 시간칸
    row.innerHTML += `<td>${time}</td>`;

    ["mon","tue","wed","thu"].forEach(day=>{
      const name = timetable[time][day];
      const td = document.createElement("td");
      td.className="selectable";
      td.innerText = name;
      td.onclick = ()=>toggleSelect(time, day, name, td);
      row.appendChild(td);
    });

    body.appendChild(row);
  });
}

function toggleSelect(time, day, name, td){
  const key = `${time}_${day}_${name}`;
  if(selectedCells.includes(key)){
    selectedCells = selectedCells.filter(x => x !== key);
    td.classList.remove("selected");
  } else {
    selectedCells.push(key);
    td.classList.add("selected");
  }
}

// ------------------------------
// 3) 보강 대상자 생성
// ------------------------------
let makeupTargets = [];

function createMakeupTargets(){
  makeupTargets = [];

  selectedCells.forEach(key=>{
    const [time, day, name] = key.split("_");
    makeupTargets.push({name, day, time});
  });

  renderMakeupTargets();
}

function renderMakeupTargets(){
  const box = document.getElementById("makeupList");
  box.innerHTML="";

  if(makeupTargets.length===0){
    box.innerHTML=`<div style="color:#888;">보강 대상자 없음</div>`;
    return;
  }

  makeupTargets.forEach(m=>{
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML = `
      <div class="name">${m.name}</div>
      <div class="sub">${m.day} / ${m.time}</div>
    `;
    box.appendChild(div);
  });

  renderNameList();
}

// ------------------------------
// 4) 보강 스케줄 생성
// ------------------------------
function showMakeupSchedule(){
  // 15분 단위 생성
  const start = 14;   // 14:00
  const end = 18;     // 18:00

  const slots = [];
  for(let h=start; h<end; h++){
    for(let m=0; m<60; m+=15){
      const hh = String(h).padStart(2,"0");
      const mm = String(m).padStart(2,"0");
      slots.push(`${hh}:${mm}`);
    }
  }

  const box = document.getElementById("timeSlots");
  box.innerHTML="";

  slots.forEach(t=>{
    const div = document.createElement("div");
    div.className="slot";
    div.innerText = t;
    div.onclick = ()=>assignTime(t, div);
    box.appendChild(div);
  });
}

// ------------------------------
// 5) 보강 대상자 + 시간 클릭 배정
// ------------------------------
let selectedName = null;

function renderNameList(){
  const box = document.getElementById("nameList");
  box.innerHTML="";

  makeupTargets.forEach((m,i)=>{
    const div = document.createElement("div");
    div.className="name-item";
    div.innerText = m.name;
    div.onclick = ()=>{
      selectedName = m.name;
      document.querySelectorAll(".name-item").forEach(n=>n.classList.remove("active"));
      div.classList.add("active");
    };
    box.appendChild(div);
  });
}

let assignedSchedule = {};

function assignTime(t, slotDiv){
  if(!selectedName){
    alert("보강 받을 사람을 먼저 선택하세요.");
    return;
  }

  assignedSchedule[t] = selectedName;

  // UI 표시
  slotDiv.classList.add("selected");
  slotDiv.innerText = `${t}  ${selectedName}`;
}

renderLessonTable();
</script>
</body>
</html>
