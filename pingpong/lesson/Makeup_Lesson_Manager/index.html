<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Makeup Lesson Manager</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Pretendard",sans-serif;
  margin:0;background:#f5f5f7;
}

/* HEADER */
header{
  background:#fff;padding:16px;
  font-size:1.3rem;font-weight:700;
  border-bottom:1px solid #ddd;
}

/* TABLE */
table{width:100%;border-collapse:collapse;background:#fff;margin-top:10px;}
th,td{border:1px solid #ccc;padding:10px;text-align:center;}
td.selectable{cursor:pointer;}
td.selected{background:#2563eb;color:white;}

/* BUTTON */
.btn{
  width:100%;padding:12px;margin-top:12px;
  background:#2563eb;color:white;border:none;
  font-size:1rem;border-radius:8px;cursor:pointer;
}

/* LIST */
.list{padding:16px;}
.item{
  background:#fff;padding:14px;margin-bottom:10px;
  border-radius:8px;
}

/* Schedule table */
.schedule-box{padding:16px;}
input{
  width:100%;padding:10px;margin:6px 0;
  border:1px solid #ccc;border-radius:8px;
}
.schedule-table td{
  height:40px;
}
</style>
</head>

<body>

<header>레슨 시간표</header>

<div style="padding:12px;">
<table>
  <thead>
    <tr>
      <th>시간</th>
      <th>월</th>
      <th>화</th>
      <th>수</th>
      <th>목</th>
    </tr>
  </thead>
  <tbody id="lessonBody"></tbody>
</table>

<button class="btn" onclick="openMakeupPopup()">보강 대상자 생성</button>
</div>

<!-- 보강 대상자 -->
<header>보강 대상자</header>
<div class="list" id="makeupList"></div>

<!-- 보강 스케쥴 -->
<header>보강 스케쥴</header>
<div class="schedule-box">

  <button class="btn" style="background:#16a34a;" onclick="openSchedulePopup()">보강 스케쥴 생성</button>

  <div id="scheduleArea" style="margin-top:16px;"></div>
</div>

<!-- 보강 대상자 생성 팝업 -->
<div id="makeupPopup" style="
 position:fixed;left:0;right:0;top:0;bottom:0;
 background:rgba(0,0,0,0.35);display:none;
">
  <div style="background:#fff;margin:100px 20px;padding:20px;border-radius:12px;">
    <h3>보강 날짜 & 사유 입력</h3>
    <input type="date" id="makeupDate">
    <input id="makeupReason" placeholder="사유 입력">
    <button class="btn" onclick="createMakeupTargets()">생성</button>
  </div>
</div>

<!-- 보강 스케줄 생성 팝업 -->
<div id="schedulePopup" style="
 position:fixed;left:0;right:0;top:0;bottom:0;
 background:rgba(0,0,0,0.35);display:none;
">
  <div style="background:#fff;margin:100px 20px;padding:20px;border-radius:12px;">
    <h3>보강 스케쥴 날짜 선택</h3>
    <input type="date" id="scheduleDate">
    <button class="btn" onclick="generateSchedule()">생성</button>
  </div>
</div>

<script>
// -------------------------
// 1) 레슨 시간표 데이터
// -------------------------
const timetable = {
  "15:00": {mon:"정승목", tue:"이세란", wed:"정승목", thu:"이세란"},
  "15:30": {mon:"이상준", tue:"박나령", wed:"이상준", thu:"박나령"},
  "16:00": {mon:"이낭주", tue:"김승일", wed:"이낭주", thu:"김승일"},
  "16:30": {mon:"조보미", tue:"송은아", wed:"조보미", thu:"송은아"},
};

let selectedCells = [];    // 선택된 레슨자
let makeupTargets = [];    // 보강 대상자
let makeupHeader = {};     // 날짜 & 사유

// -------------------------
// 2) 시간표 렌더링
// -------------------------
function renderLessonTable(){
  const body = document.getElementById("lessonBody");
  body.innerHTML = "";

  Object.keys(timetable).forEach(time=>{
    const tr = document.createElement("tr");
    tr.innerHTML += `<td>${time}</td>`;

    ["mon","tue","wed","thu"].forEach(day=>{
      const name = timetable[time][day];
      const td = document.createElement("td");
      td.className = "selectable";
      td.innerText = name;
      td.onclick = ()=>toggleSelect(time,day,name,td);
      tr.appendChild(td);
    });

    body.appendChild(tr);
  });
}

function toggleSelect(time,day,name,td){
  const key = `${time}_${day}_${name}`;
  
  if(selectedCells.includes(key)){
    selectedCells = selectedCells.filter(x=>x!==key);
    td.classList.remove("selected");
  }else{
    selectedCells.push(key);
    td.classList.add("selected");
  }
}

// -------------------------
// 3) 보강 대상자 생성 팝업
// -------------------------
function openMakeupPopup(){
  if(selectedCells.length===0){
    alert("레슨 시간표에서 보강할 인원을 선택하세요.");
    return;
  }
  document.getElementById("makeupPopup").style.display="block";
}

// -------------------------
// 4) 보강 대상자 생성
// -------------------------
function createMakeupTargets(){
  const date = document.getElementById("makeupDate").value;
  const reason = document.getElementById("makeupReason").value;

  if(!date || !reason){
    alert("날짜와 사유를 입력하세요.");
    return;
  }

  makeupHeader = {date, reason};
  makeupTargets = [];

  selectedCells.forEach(key=>{
    const [time,day,name] = key.split("_");
    makeupTargets.push({name});
  });

  selectedCells = [];
  document.getElementById("makeupPopup").style.display="none";

  renderMakeupList();
  renderLessonTable();
}

// -------------------------
// 5) 보강 대상자 리스트 렌더
// -------------------------
function renderMakeupList(){
  const box = document.getElementById("makeupList");
  box.innerHTML="";

  if(!makeupHeader.date){
    box.innerHTML = `<div style="color:#666;">보강 대상자 없음</div>`;
    return;
  }

  // 맨 위: 날짜 + 사유
  const head = document.createElement("div");
  head.className="item";
  head.innerHTML = `<strong>${makeupHeader.date} / ${makeupHeader.reason}</strong>`;
  box.appendChild(head);

  // 아래: 이름만
  makeupTargets.forEach(m=>{
    const div = document.createElement("div");
    div.className="item";
    div.innerHTML = m.name;
    box.appendChild(div);
  });
}

// -------------------------
// 6) 보강 스케쥴 생성 팝업
// -------------------------
function openSchedulePopup(){
  document.getElementById("schedulePopup").style.display="block";
}

function generateSchedule(){
  const date = document.getElementById("scheduleDate").value;
  if(!date){
    alert("날짜를 입력하세요.");
    return;
  }

  document.getElementById("schedulePopup").style.display="none";

  const box = document.getElementById("scheduleArea");
  box.innerHTML = `<h3>${date} 보강 스케쥴</h3>`;

  // 시간표 생성
  let html = `<table class="schedule-table"><tr><th>시간</th><th>보강자</th></tr>`;
  
  for(let h=14;h<18;h++){
    for(let m=0;m<60;m+=15){
      const hh = String(h).padStart(2,"0");
      const mm = String(m).padStart(2,"0");
      const t = `${hh}:${mm}`;

      html += `
        <tr>
          <td>${t}</td>
          <td contenteditable="true" style="background:#fff;"></td>
        </tr>
      `;
    }
  }

  html += `</table>`;
  box.innerHTML += html;
}

renderLessonTable();
renderMakeupList();
</script>

</body>
</html>
