<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ“ ì„ ìˆ˜ ì •ë³´ ì…ë ¥ & GPTsìš© ë°ì´í„° ìƒì„±</title>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">

<style>
:root{
  --ink:#0f172a; --bg:#f5f7fb; --card:#fff;
  --accent:#2563eb; --muted:#64748b;
  --shadow:0 4px 20px rgba(0,0,0,.06);
}
body{
  margin:0; padding:0;
  font-family:"Pretendard","Noto Sans KR",sans-serif;
  background:var(--bg); color:var(--ink); font-weight:600;
}
.wrap{max-width:1000px;margin:0 auto;padding:16px;}

h1{
  font-size:22px; margin:0 0 10px;
  font-weight:900; color:#1e3a8a;
}
.card{
  background:var(--card); padding:16px; border-radius:14px;
  box-shadow:var(--shadow); margin:12px 0; border:1px solid #e5e7eb;
}
select, input, textarea{
  width:100%; font-size:15px; font-weight:600;
  padding:10px; border:1px solid #d1d5db; border-radius:10px;
}
textarea{min-height:120px; resize:vertical;}
.row{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
.btn{
  padding:10px 16px; font-size:14px; font-weight:800;
  border-radius:10px; border:1px solid #cbd5e1;
  cursor:pointer; background:#fff;
}
.btn.primary{background:var(--accent); color:#fff; border-color:var(--accent);}
.list{display:grid; gap:8px; grid-template-columns: repeat(auto-fit, minmax(160px,1fr));}
.player-item{
  padding:10px; background:#fff;
  border-radius:10px; border:1px solid #e5e7eb;
  text-align:center; cursor:pointer; transition:.2s;
}
.player-item:hover{background:#eef2ff;}
.label{font-size:14px; color:var(--muted); margin-top:10px;}
.preview-box{
  width:100%; min-height:300px; padding:14px;
  font-size:13.5px; white-space:pre-wrap;
  border:1px solid #e5e7eb; border-radius:12px;
  background:#fff;
}
</style>
</head>

<body>
<div class="wrap">

<h1>ğŸ“ ì„ ìˆ˜ ì •ë³´ ì…ë ¥ & GPTsìš© ë°ì´í„° ìƒì„±</h1>

<!-- âœ… ì„ ìˆ˜ ëª©ë¡ -->
<div class="card">
  <h3>ì„ ìˆ˜ ì„ íƒ</h3>
  <div id="playerList" class="list"></div>
</div>

<!-- âœ… ì„ ìˆ˜ ì •ë³´ ì…ë ¥ -->
<div class="card">
  <h3 id="playerTitle">ì„ ìˆ˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</h3>

  <div class="label">ê·¸ë¦½(grip)</div>
  <input id="in_grip" placeholder="ì˜ˆ: ì‰ì´í¬, íœí™€ë”">

  <div class="label">ê²½ë ¥(years)</div>
  <input id="in_years" placeholder="ì˜ˆ: 3ë…„">

  <div class="label">ë ˆìŠ¨(lesson)</div>
  <input id="in_lesson" placeholder="ì˜ˆ: ì£¼ 1íšŒ / ì—†ìŒ">

  <div class="label">í”Œë ˆì´ìŠ¤íƒ€ì¼(playstyle)</div>
  <textarea id="in_playstyle" placeholder="í”Œë ˆì´ ìŠ¤íƒ€ì¼"></textarea>

  <div class="label">ê°•ì (strong)</div>
  <textarea id="in_strong" placeholder="ê°•ì "></textarea>

  <div class="label">ì•½ì (weak)</div>
  <textarea id="in_weak" placeholder="ì•½ì "></textarea>

  <div class="label">ê´€ë¦¬ì ë©”ëª¨(memo)</div>
  <textarea id="in_memo" placeholder="ê´€ë¦¬ì ì°¸ê³  ë©”ëª¨"></textarea>

  <button class="btn primary" id="btnSave">ì €ì¥</button>
</div>

<!-- âœ… ì „ì²´ ë©”ëª¨ -->
<div class="card">
  <h3>ğŸ“Œ ì „ì²´ ì¶”ê°€ ë©”ëª¨ (ì„ ìˆ˜ ê³µí†µ)</h3>
  <textarea id="extraMemo" placeholder="ì „ì²´ ì°¸ê³  ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš” (GPTs ë¶„ì„ì— í¬í•¨ë¨)"></textarea>
  <button class="btn primary" id="btnSaveExtra">ì „ì²´ ë©”ëª¨ ì €ì¥</button>
</div>

<!-- âœ… ì¶œë ¥ -->
<div class="card">
  <h3>ğŸ“¤ GPTsìš© í…ìŠ¤íŠ¸ ì¶œë ¥</h3>
  <button class="btn primary" id="btnBuild">ì „ì²´ ë‚´ìš© ìƒì„±</button>
  <button class="btn" id="btnCopy">ì „ì²´ ë³µì‚¬</button>
  <div class="preview-box" id="outBox"></div>
</div>

</div>

<script type="module">
/* -------------------------
   Firebase ê¸°ë³¸ ì„¤ì •
------------------------- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey:"AIzaSyArRznuWhfuiOA1vFtwlArMCLsAdTz6XHo",
  authDomain:"pingpongclub-4a5fd.firebaseapp.com",
  databaseURL:"https://pingpongclub-4a5fd-default-rtdb.firebaseio.com",
  projectId:"pingpongclub-4a5fd",
  storageBucket:"pingpongclub-4a5fd.firebasestorage.app",
  messagingSenderId:"802826774007",
  appId:"1:802826774007:web:ca4d05be778eeaf1723af2"
};
initializeApp(firebaseConfig);
const db = getDatabase();



/* -------------------------
   ì„ ìˆ˜ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
------------------------- */
let PLAYERS = [];
let CURRENT = "";

const $ = (s)=>document.querySelector(s);

async function loadPlayers(){
  const s = await get(ref(db,'players'));
  if (!s.exists()) return;
  PLAYERS = Object.values(s.val()).map(p=>p.name).filter(Boolean);
  renderPlayers();
}

function renderPlayers(){
  const box = $("#playerList");
  box.innerHTML = "";

  PLAYERS.sort((a,b)=>a.localeCompare(b,'ko'));

  PLAYERS.forEach(name=>{
    const div = document.createElement("div");
    div.className = "player-item";
    div.textContent = name;
    div.onclick = ()=> selectPlayer(name);
    box.appendChild(div);
  });
}



/* -------------------------
   ì„ ìˆ˜ ì„ íƒ â†’ ë°ì´í„° ë¡œë“œ
------------------------- */
function selectPlayer(name){
  CURRENT = name;
  $("#playerTitle").textContent = `ì„ ìˆ˜: ${name}`;

  // localStorage ì €ì¥ êµ¬ì¡°: playerInfo_{ì´ë¦„}
  const key = "playerInfo_" + name;
  const saved = JSON.parse(localStorage.getItem(key) || "{}");

  $("#in_grip").value = saved.grip || "";
  $("#in_years").value = saved.years || "";
  $("#in_lesson").value = saved.lesson || "";
  $("#in_playstyle").value = saved.playstyle || "";
  $("#in_strong").value = saved.strong || "";
  $("#in_weak").value = saved.weak || "";
  $("#in_memo").value = saved.memo || "";
}



/* -------------------------
   ì„ ìˆ˜ ì •ë³´ ì €ì¥
------------------------- */
$("#btnSave").onclick = ()=>{
  if (!CURRENT){
    alert("ì„ ìˆ˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.");
    return;
  }
  const key = "playerInfo_" + CURRENT;

  const data = {
    grip: $("#in_grip").value,
    years: $("#in_years").value,
    lesson: $("#in_lesson").value,
    playstyle: $("#in_playstyle").value,
    strong: $("#in_strong").value,
    weak: $("#in_weak").value,
    memo: $("#in_memo").value
  };

  localStorage.setItem(key, JSON.stringify(data));
  alert("âœ… ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
};



/* -------------------------
   ì „ì²´ ë©”ëª¨ ì €ì¥
------------------------- */
$("#btnSaveExtra").onclick = ()=>{
  localStorage.setItem("extraMemo", $("#extraMemo").value);
  alert("âœ… ì „ì²´ ë©”ëª¨ ì €ì¥ë¨");
};


/* -------------------------
   GPTs ì¶œë ¥ ìƒì„±
------------------------- */
$("#btnBuild").onclick = ()=>{
  let txt = `# KOEN í´ëŸ½ â€” ì„ ìˆ˜ ì •ë³´ ë°ì´í„°\n\n`;

  PLAYERS.forEach(name=>{
    const key = "playerInfo_" + name;
    const saved = JSON.parse(localStorage.getItem(key) || "{}");

    txt += `## ${name}\n`;
    txt += `grip: ${saved.grip || "-"}\n`;
    txt += `years: ${saved.years || "-"}\n`;
    txt += `lesson: ${saved.lesson || "-"}\n`;
    txt += `playstyle: ${saved.playstyle || "-"}\n`;
    txt += `strong: ${saved.strong || "-"}\n`;
    txt += `weak: ${saved.weak || "-"}\n`;
    txt += `memo: ${saved.memo || "-"}\n\n`;
  });

  txt += `# ì „ì²´ ì¶”ê°€ ë©”ëª¨\n${$("#extraMemo").value || ""}\n`;

  $("#outBox").textContent = txt;
};



/* -------------------------
   ì „ì²´ ë³µì‚¬
------------------------- */
$("#btnCopy").onclick = async ()=>{
  await navigator.clipboard.writeText($("#outBox").textContent);
  alert("âœ… ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. GPTsì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.");
};


/* -------------------------
   ì‹œì‘
------------------------- */
$("#extraMemo").value = localStorage.getItem("extraMemo") || "";
loadPlayers();

</script>
</body>
</html>
