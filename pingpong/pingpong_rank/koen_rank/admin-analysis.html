<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğŸ“ ê´€ë¦¬ì ë¶„ì„ ì…ë ¥</title>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">

<style>
body{
  margin:0; padding:20px;
  background:#f5f7fb;
  font-family:"Pretendard","Noto Sans KR",sans-serif;
}
h1{
  font-size:22px; font-weight:900; color:#1e3a8a;
  margin-bottom:15px;
}
textarea{
  width:100%; height:380px;
  border:1px solid #cbd5e1;
  border-radius:12px;
  padding:14px;
  font-size:15px;
  line-height:1.6;
  resize:none;
}
button{
  margin-top:14px;
  background:#2563eb;
  border:none;
  padding:12px 16px;
  border-radius:10px;
  color:white;
  font-size:15px;
  font-weight:800;
  cursor:pointer;
}
button:hover{
  background:#1d4ed8;
}
.msg{
  margin-top:14px;
  font-size:15px;
  font-weight:700;
  color:#0f172a;
}
</style>
</head>

<body>

<h1>ğŸ“ ê´€ë¦¬ì ë¶„ì„ ì…ë ¥</h1>

<p style="font-size:15px; color:#475569; margin-bottom:10px;">
ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.<br>
<code>ì´ë¦„:</code> ë‹¤ìŒ ì¤„ë¶€í„° ë‚´ìš© ì‘ì„± â†’ ë¹ˆ ì¤„ ë‚˜ì˜¤ë©´ ë.
</p>

<pre style="background:#eef2ff; padding:10px 14px; border-radius:10px; font-size:14px; line-height:1.5; color:#1e3a8a;">
ì •ìŠ¹ëª©:
ì •ìŠ¹ëª©ì€ ë°±í•¸ë“œ ì•ˆì •ì„±ì´ ë†’ê³  ...

ê¹€ìŠ¹ì¼:
ê¹€ìŠ¹ì¼ì€ ì„œë¸Œì˜ êµ¬ì§ˆ ë³€í™”ê°€ ì¢‹ìœ¼ë©° ...
</pre>

<textarea id="inputBox" placeholder="ì—¬ê¸°ì— ì „ì²´ ë¶„ì„ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>

<button id="saveBtn">âœ… ì „ì²´ ë¶„ì„ ì €ì¥</button>

<div id="msg" class="msg"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyArRznuWhfuiOA1vFtwlArMCLsAdTz6XHo",
  authDomain: "pingpongclub-4a5fd.firebaseapp.com",
  databaseURL: "https://pingpongclub-4a5fd-default-rtdb.firebaseio.com",
  projectId: "pingpongclub-4a5fd",
  storageBucket: "pingpongclub-4a5fd.firebasestorage.app",
  messagingSenderId: "802826774007",
  appId: "1:802826774007:web:ca4d05be778eeaf1723af2"
};
const app = initializeApp(firebaseConfig);
const db  = getDatabase(app);

// âœ… ë¶„ì„ ì €ì¥ ê¸°ëŠ¥
document.getElementById("saveBtn").addEventListener("click", async () => {
  const raw = document.getElementById("inputBox").value.trim();
  const msg = document.getElementById("msg");

  if (!raw){
    msg.textContent = "âŒ ì…ë ¥ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.";
    msg.style.color = "#dc2626";
    return;
  }

  // âœ… ì´ë¦„ ê¸°ì¤€ìœ¼ë¡œ split
  // í˜•ì‹:  "í™ê¸¸ë™:\në‚´ìš©\n\nê¹€ì² ìˆ˜:\në‚´ìš©..."
  const blocks = raw.split(/\n(?=[^:\n]+:)/);

  let count = 0;

  for (let block of blocks){
    const lines = block.trim().split("\n");
    const firstLine = lines.shift();

    if (!firstLine.includes(":")) continue;

    const name = firstLine.replace(":", "").trim();
    const content = lines.join("\n").trim();

    if (!name || !content) continue;

    await set(ref(db, `analysis/${name}/analysis`), content);
    count++;
  }

  msg.textContent = `âœ… ${count}ëª… ë¶„ì„ ì €ì¥ ì™„ë£Œ`;
  msg.style.color = "#0f172a";
});
</script>

</body>
</html>
