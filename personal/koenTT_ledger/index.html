<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>koenTT_ledger</title>

<style>
  body {
    margin:0; background:#f5f7fb;
    font-family:"Pretendard","Noto Sans KR",sans-serif;
    color:#0f172a;
  }
  header {
    background:#fff; padding:16px; 
    font-size:20px; font-weight:700;
    text-align:center;
    border-bottom:1px solid #e5e7eb;
    position:sticky; top:0; z-index:10;
  }
  .input-box {
    padding:12px; background:#fff;
    display:flex; gap:8px; flex-direction:column;
    border-bottom:1px solid #e5e7eb;
  }
  .input-box input {
    width:100%; padding:12px;
    font-size:15px;
    border:1px solid #d1d5db;
    border-radius:8px;
  }
  .add-btn {
    width:100%;
    background:#2563eb; color:white;
    padding:12px; font-size:16px;
    border:none; border-radius:8px;
    font-weight:600; margin-top:4px;
  }

  .table-wrapper { padding:12px; }
  table {
    width:100%; border-collapse:collapse;
    background:#fff; border-radius:12px;
    overflow:hidden;
    box-shadow:0 4px 16px rgba(0,0,0,0.06);
  }
  th, td {
    padding:12px 6px;
    text-align:center;
    border-bottom:1px solid #f1f5f9;
    font-size:14px;
  }
  td input {
    width:95%; padding:6px;
    border:1px solid #d1d5db;
    border-radius:6px;
    font-size:14px;
    text-align:center;
  }
  .del-btn {
    background:#ef4444; color:white;
    border:none; border-radius:6px;
    padding:6px 8px; font-size:12px;
  }
</style>
</head>

<body>

<header>koenTT_ledger</header>

<!-- ✅ 입력 영역 -->
<div class="input-box">
  <input type="text" id="desc" placeholder="내역 입력">
  <input type="number" id="income" placeholder="입금 금액">
  <input type="number" id="expense" placeholder="출금 금액">
  <button class="add-btn" onclick="addRow()">추가하기</button>
</div>

<div class="table-wrapper">
  <table>
    <thead>
      <tr>
        <th>일자</th>
        <th>내역</th>
        <th>입금</th>
        <th>출금</th>
        <th>잔액</th>
        <th></th>
      </tr>
    </thead>
    <tbody id="ledger-body"></tbody>
  </table>
</div>

<script>
  let ledger = JSON.parse(localStorage.getItem("koenTT_ledger") || "[]");

  function save() {
    localStorage.setItem("koenTT_ledger", JSON.stringify(ledger));
  }

  function render() {
    const body = document.getElementById("ledger-body");
    body.innerHTML = "";

    let balance = 0;

    ledger.forEach((row, index) => {
      balance += (Number(row.income) - Number(row.expense));
      row.balance = balance;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="date" value="${row.date}" onchange="edit(${index}, 'date', this.value)"></td>
        <td><input value="${row.desc}" onchange="edit(${index}, 'desc', this.value)"></td>
        <td><input type="number" value="${row.income}" onchange="edit(${index}, 'income', this.value)"></td>
        <td><input type="number" value="${row.expense}" onchange="edit(${index}, 'expense', this.value)"></td>
        <td>${balance.toLocaleString()}</td>
        <td><button class="del-btn" onclick="removeRow(${index})">삭제</button></td>
      `;
      body.appendChild(tr);
    });

    save();
  }

  function today() {
    const d = new Date();
    return d.toISOString().slice(0, 10);
  }

  function addRow() {
    const desc = document.getElementById("desc").value.trim();
    const income = Number(document.getElementById("income").value || 0);
    const expense = Number(document.getElementById("expense").value || 0);

    if (!desc) { alert("내역을 입력하세요."); return; }

    ledger.push({
      date: today(),
      desc,
      income,
      expense,
      balance: 0
    });

    document.getElementById("desc").value = "";
    document.getElementById("income").value = "";
    document.getElementById("expense").value = "";

    render();
  }

  function edit(index, field, value) {
    ledger[index][field] = value;
    render();
  }

  function removeRow(index) {
    ledger.splice(index, 1);
    render();
  }

  render();
</script>

</body>
</html>
